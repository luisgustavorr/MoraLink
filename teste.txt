SELECT RECEITA.ID_RECEITA AS \"id_externo\", RECEITA.ID_PESSOA AS \"cliente\", 1 AS \"vendedor\", RECEITA.EMISSAO AS \"data_compra\", SUM(ITEM_RECEITA.PRECO * ITEM_RECEITA.QUANTIDADE - ITEM_RECEITA.VALOR_DESCONTO) AS \"total_compra\", SUM(ITEM_RECEITA.PRECO * ITEM_RECEITA.QUANTIDADE - ITEM_RECEITA.VALOR_DESCONTO) AS \"valor_liquido\", CASE WHEN COUNT(PARCELA_RECEITA.ID_PARCELA_RECEITA) > 0 THEN 'parcelado' ELSE 'a_vista' END AS \"tipo_pagamento\", 0 AS \"recorrente\", COUNT(PARCELA_RECEITA.ID_PARCELA_RECEITA) AS \"parcelas\", 0 AS \"entrada\", NULL AS \"data_vencimento\", 'pix' AS \"metodo_pagamento\", FALSE AS \"orcamento\", '[' || LIST('{\"produto_id\": ' || ITEM_RECEITA.ID_PRODUTO || ', \"valor_unitario\": ' || ITEM_RECEITA.PRECO || '}', ', ') || ']' AS \"produtos_venda\", '[' || LIST('{\"data_vencimento\": \"' || PARCELA_RECEITA.VENCIMENTO || '\"}', ', ') || ']' AS \"datas_vencimento\" FROM ITEM_RECEITA INNER JOIN PRODUTO ON PRODUTO.ID_PRODUTO = ITEM_RECEITA.ID_PRODUTO INNER JOIN RECEITA ON RECEITA.ID_RECEITA = ITEM_RECEITA.ID_RECEITA INNER JOIN PARCELA_RECEITA ON PARCELA_RECEITA.ID_RECEITA = ITEM_RECEITA.ID_RECEITA WHERE RECEITA.EMISSAO >= '2025-02-01' GROUP BY RECEITA.ID_RECEITA, RECEITA.ID_PESSOA, RECEITA.ID_VENDEDOR, RECEITA.EMISSAO ORDER BY RECEITA.ID_RECEITA DESC;